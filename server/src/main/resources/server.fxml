<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="vn.edu.demo.caro.server.controller.ServerController"
            stylesheets="@server.css"
            prefWidth="900" prefHeight="600" styleClass="root">

    <top>
        <HBox alignment="CENTER_LEFT" spacing="15" styleClass="header">
            <padding><Insets top="15" right="20" bottom="15" left="20"/></padding>
            <Label text="CARO SERVER MANAGER" styleClass="h1"/>
            <Region HBox.hgrow="ALWAYS"/>
            <HBox alignment="CENTER" spacing="8">
                <Circle fx:id="statusDot" radius="6" fill="#7f8c8d"/>
                <Label fx:id="lbStatus" text="Stopped" styleClass="status-text"/>
            </HBox>
            <Button fx:id="btnToggle" text="START SERVER" onAction="#onToggleServer" styleClass="btn-start"/>
        </HBox>
    </top>

    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE" styleClass="main-tabs">
            
            <Tab text="LOGS SYSTEM">
                <VBox spacing="10" styleClass="panel">
                    <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>
                    <TextArea fx:id="txtLog" editable="false" wrapText="true" VBox.vgrow="ALWAYS" styleClass="console"/>
                </VBox>
            </Tab>

            <Tab text="ONLINE USERS">
                <VBox spacing="10" styleClass="panel">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    
                    <TableView fx:id="tvUsers" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colUser" text="Username" prefWidth="150"/>
                            <TableColumn fx:id="colElo" text="Elo" prefWidth="80"/>
                            <TableColumn fx:id="colWins" text="Wins" prefWidth="80"/>
                            <TableColumn fx:id="colStatus" text="Status" prefWidth="100"/>
                        </columns>
                        <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                    </TableView>

                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Hành động:" styleClass="label-bold"/>
                        <Button text="Cảnh báo (Warn)" onAction="#onWarnUser" styleClass="btn-warn"/>
                        <Button text="Khóa (Ban 30p)" onAction="#onBanUser" styleClass="btn-stop"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="lbUserCount" text="Online: 0" styleClass="muted"/>
                    </HBox>
                </VBox>
            </Tab>

            <Tab text="ROOMS">
                <VBox spacing="10" styleClass="panel">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    <TableView fx:id="tvRooms" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colRoomId" text="Room ID" prefWidth="250"/>
                            <TableColumn fx:id="colRoomName" text="Tên phòng" prefWidth="150"/>
                            <TableColumn fx:id="colOwner" text="Chủ phòng" prefWidth="100"/>
                            <TableColumn fx:id="colPlayers" text="Người chơi" prefWidth="150"/>
                            <TableColumn fx:id="colRoomStatus" text="Trạng thái" prefWidth="100"/>
                        </columns>
                        <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                    </TableView>
                    <Label fx:id="lbRoomCount" text="Active Rooms: 0" styleClass="muted"/>
                </VBox>
            </Tab>

            <Tab text="BROADCAST">
                <VBox spacing="15" styleClass="panel" alignment="TOP_CENTER">
                    <padding><Insets top="30" right="30" bottom="30" left="30"/></padding>
                    
                    <Label text="Gửi thông báo toàn Server" styleClass="h2"/>
                    <TextArea fx:id="txtBroadcast" promptText="Nhập nội dung thông báo..." prefHeight="100" wrapText="true"/>
                    
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Button text="Gửi Thông Báo" onAction="#onBroadcast" styleClass="btn-start" prefWidth="150"/>
                    </HBox>
                    
                    <Separator/>
                    <Label text="* Tin nhắn này sẽ hiện popup trên màn hình tất cả người chơi đang online." styleClass="muted" wrapText="true"/>
                </VBox>
            </Tab>

        </TabPane>
    </center>
</BorderPane>